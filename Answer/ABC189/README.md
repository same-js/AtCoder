# 所感など

AtCoderコンテスト初挑戦。  
競技プログラミングってどんなもんだろうか？と軽い気持ちで参加してみたが、普通におもしろかった。

A・B・C・D・E・Fの6問を時間制限100分の間に、できるところまで解く、という形式のもので、  
**「何だかんだ言っても、3問（A・B・C）ぐらいは解けるのでは？」** と思っていたが、甘かった。

Bで大幅に時間を消費してしまい、2問だけでおしまい。

## 問題A
| 項目 | 内容 | 備考 |
| --- | --- | --- |
| 問題 | https://atcoder.jp/contests/abc189/tasks/abc189_a |
| 回答言語 | PHP 7.4.4 |  |
| 得点 | 100 / 100
| 提出 | 1回 | |
| 最終的な回答提出にかかった時間 | 約10分 | |

回答を作るまではそこまで時間がかからなかったが、提出までの間に、検証に時間をかけすぎた。

というのも、ひとつの問題につき、回答は何度もできるという仕様を知らなかったため。  
誤答を提出するたびに一定のペナルティはあるものの、コンテスト時間内に正解を提出できれば、満点扱いになるらしい。

同じようなサービスのPaizaはやったことがあるのだが、こちらは一回しか回答が許されないため、  
無意識のうちにAtCoderも同じ仕様だと思っていた。

（厳密には、Paizaも回答は何度も提出できるが、最初に提出した回答でレーティングとランクが変動し、  
以降の提出では満点だろうと0点だろうとレーティングやランクに影響を与えない）

## 公式解説を読んで

回答作成中も「もっと良い書き方、絶対あるだろうな・・・」と思っていたが、案の定その通りだった。

```php
$arr = str_split($s);
if ( $arr[0] === $arr[1] && $arr[1] === $arr[2] ) { ... }
```


でよかったようだ。

## 問題B
| 項目 | 内容 | 備考 |
| --- | --- | --- |
| 問題 | https://atcoder.jp/contests/abc189/tasks/abc189_b |
| 回答言語 | Python 3.8.2 | 最初はPHPで解いたが、途中でPythonに書き直し |
| 得点 | 200 / 200 |
| 提出 | 3回 | `WA` -> `WA` -> `AC` |
| 最終的な回答提出にかかった時間 | 約60分 | |

### 所感

不動小数点を含む計算を正しく扱えるか？を問われる問題。

最初PHPで解き、最終的な回答まで書いたが、提出しても何故か `WA（誤答）` 扱い。

なぜ？等号・不等号は間違いないはずだし・・・。

と考えていたが、これ不動小数点計算だから、計算結果がおかしくなっているのでは？と気付いた。

そこで、この手の計算はPHPよりPythonのほうが得意なはずだと考え、  
全て書き終えたPHPの回答を全て破棄してPythonで書き直し、  
かつDecimal関数を通して行うように書き直して提出。

結果、無事 `AC（正答）` を獲得。  

基本情報の学習で不動小数点について一度学んでいたことと、  
過去にJavaで決済の計算処理を実装した際、BigDecimalクラスが必須だったことを思い出せたことで、何とかなった。

### 公式解説を読んで

わざわざPythonに書き直したり、Decimal関数を使わなくても、  
左辺と右辺に100を乗算し、式の数字が全て整数になるように式変形をして計算すれば済む話だったようだ。

つまり、提出した回答は

```py
alc = Decimal(v) * (Decimal(p) / Decimal(100))
now = Decimal(now) + Decimal(alc)

if Decimal(x) < Decimal(now):
```

だったが、

```py
alc = (v*100) * p
now = now + alc

if (x*100) < now :
```

でよかった、ということ。

## 全体を通して

### やっぱりPythonは書きやすい
今回はAtCoderそのものに慣れるという意図があったため、  
言語は最近よく仕事で使っているPHPで解き始めた。

しかし、途中でPythonに変更してみて、  
やっぱりPythonはかなり書きやすいと感じた。

今後、AtCoderで使用する言語は、基本的にPython一択でいいな、と思った。

### 不動小数点計算は注意が必要

B問題の解説では、 `不動小数点の演算は一般に誤差を含みます` と冒頭にある。

確かに、これはその通りで、もしこれを知らずに小数を含む計算（消費税計算やポイント付与・消費計算など）を  
商用環境で実装してしまった場合、場合によっては（割と甚大な）損害を起こしかねない。

実務での計算処理の実装時には気をつけなければと、改めて感じた。
